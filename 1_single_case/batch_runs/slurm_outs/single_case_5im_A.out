14:18:16
2025-03-18 14:18:18.258081: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-03-18 14:18:18.258126: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-03-18 14:18:18.258971: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-03-18 14:18:18.263579: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE4.1 SSE4.2 AVX AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-03-18 14:19:45.378363: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1929] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 79077 MB memory:  -> device: 0, name: NVIDIA A100-SXM4-80GB, pci bus id: 0000:01:00.0, compute capability: 8.0


--------------------------------------
SINGLE -------------------------------
5-im case ----------------------------

Params:

flag_remove_extremes:  False
flag_use_augmented:  False

flag_black:  True

flag_black_inner:  False
R:  6

Normalization by
five-images

arr_learn_rates:  [1e-06, 1e-07]
arr_epochs:  [100, 10]
batch_size:  16
patience:  30

--------------------------------------


X.shape:  (8651, 5, 112, 112)

Shape of X_tr: (6055, 5, 112, 112)
Shape of X_vl: (1298, 5, 112, 112)
Shape of X_ts: (1298, 5, 112, 112)

Shape of Y_tr: (6055,)
Shape of Y_vl: (1298,)
Shape of Y_ts: (1298,)

Shape of use_X_tr: (6055, 112, 112, 5)
Shape of use_X_vl: (1298, 112, 112, 5)
Shape of use_X_ts: (1298, 112, 112, 5)

Shape of use_Y_tr: (6055,)
Shape of use_Y_vl: (1298,)
Shape of use_Y_ts: (1298,)

nrm_X_tr.shape
(6055, 112, 112, 5)

nrm_X_tr.shape
(6055, 112, 112, 5)


MODEL 0

Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 conv2d (Conv2D)             (None, 110, 110, 128)     5888      
                                                                 
 max_pooling2d (MaxPooling2  (None, 55, 55, 128)       0         
 D)                                                              
                                                                 
 conv2d_1 (Conv2D)           (None, 53, 53, 256)       295168    
                                                                 
 max_pooling2d_1 (MaxPoolin  (None, 26, 26, 256)       0         
 g2D)                                                            
                                                                 
 max_pooling2d_2 (MaxPoolin  (None, 13, 13, 256)       0         
 g2D)                                                            
                                                                 
 conv2d_2 (Conv2D)           (None, 11, 11, 512)       1180160   
                                                                 
 flatten (Flatten)           (None, 61952)             0         
                                                                 
 dense (Dense)               (None, 512)               31719936  
                                                                 
 dense_1 (Dense)             (None, 256)               131328    
                                                                 
 dense_2 (Dense)             (None, 128)               32896     
                                                                 
 dense_3 (Dense)             (None, 1)                 129       
                                                                 
=================================================================
Total params: 33365505 (127.28 MB)
Trainable params: 33365505 (127.28 MB)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________
2025-03-18 14:19:47.274586: I external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:454] Loaded cuDNN version 8907
2025-03-18 14:19:47.874754: I external/local_xla/xla/service/service.cc:168] XLA service 0x148dd556c160 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2025-03-18 14:19:47.874798: I external/local_xla/xla/service/service.cc:176]   StreamExecutor device (0): NVIDIA A100-SXM4-80GB, Compute Capability 8.0
2025-03-18 14:19:47.878942: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:269] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1742321987.951009 1580664 device_compiler.h:186] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
Training Finished

Tr. Final MSE (nrm. units): 0.012386288493871689
Vl. Final MSE (nrm. units): 0.013576053082942963
Ts. Final MSE (nrm. units): 0.011184594593942165
Tr. Final MdAE (dnrm. units): 0.3638945770263672
Vl. Final MdAE (dnrm. units): 0.4008889436721802
Ts. Final MdAE (dnrm. units): 0.350950562953949

MODEL 1

Model: "sequential_1"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 conv2d_3 (Conv2D)           (None, 110, 110, 128)     5888      
                                                                 
 max_pooling2d_3 (MaxPoolin  (None, 55, 55, 128)       0         
 g2D)                                                            
                                                                 
 conv2d_4 (Conv2D)           (None, 53, 53, 256)       295168    
                                                                 
 max_pooling2d_4 (MaxPoolin  (None, 26, 26, 256)       0         
 g2D)                                                            
                                                                 
 max_pooling2d_5 (MaxPoolin  (None, 13, 13, 256)       0         
 g2D)                                                            
                                                                 
 conv2d_5 (Conv2D)           (None, 11, 11, 512)       1180160   
                                                                 
 flatten_1 (Flatten)         (None, 61952)             0         
                                                                 
 dense_4 (Dense)             (None, 512)               31719936  
                                                                 
 dense_5 (Dense)             (None, 256)               131328    
                                                                 
 dense_6 (Dense)             (None, 128)               32896     
                                                                 
 dense_7 (Dense)             (None, 1)                 129       
                                                                 
=================================================================
Total params: 33365505 (127.28 MB)
Trainable params: 33365505 (127.28 MB)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________
Training Finished

Tr. Final MSE (nrm. units): 0.01240195520222187
Vl. Final MSE (nrm. units): 0.013395139016211033
Ts. Final MSE (nrm. units): 0.011222711764276028
Tr. Final MdAE (dnrm. units): 0.35392146587371826
Vl. Final MdAE (dnrm. units): 0.3878681969642639
Ts. Final MdAE (dnrm. units): 0.32967324256896974

MODEL 2

Model: "sequential_2"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 conv2d_6 (Conv2D)           (None, 110, 110, 128)     5888      
                                                                 
 max_pooling2d_6 (MaxPoolin  (None, 55, 55, 128)       0         
 g2D)                                                            
                                                                 
 conv2d_7 (Conv2D)           (None, 53, 53, 256)       295168    
                                                                 
 max_pooling2d_7 (MaxPoolin  (None, 26, 26, 256)       0         
 g2D)                                                            
                                                                 
 max_pooling2d_8 (MaxPoolin  (None, 13, 13, 256)       0         
 g2D)                                                            
                                                                 
 conv2d_8 (Conv2D)           (None, 11, 11, 512)       1180160   
                                                                 
 flatten_2 (Flatten)         (None, 61952)             0         
                                                                 
 dense_8 (Dense)             (None, 512)               31719936  
                                                                 
 dense_9 (Dense)             (None, 256)               131328    
                                                                 
 dense_10 (Dense)            (None, 128)               32896     
                                                                 
 dense_11 (Dense)            (None, 1)                 129       
                                                                 
=================================================================
Total params: 33365505 (127.28 MB)
Trainable params: 33365505 (127.28 MB)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________
Training Finished

Tr. Final MSE (nrm. units): 0.012045749463140965
Vl. Final MSE (nrm. units): 0.013117904774844646
Ts. Final MSE (nrm. units): 0.01120244525372982
Tr. Final MdAE (dnrm. units): 0.3492940616607666
Vl. Final MdAE (dnrm. units): 0.395707004070282
Ts. Final MdAE (dnrm. units): 0.33121997356414795

MODEL 3

Model: "sequential_3"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 conv2d_9 (Conv2D)           (None, 110, 110, 128)     5888      
                                                                 
 max_pooling2d_9 (MaxPoolin  (None, 55, 55, 128)       0         
 g2D)                                                            
                                                                 
 conv2d_10 (Conv2D)          (None, 53, 53, 256)       295168    
                                                                 
 max_pooling2d_10 (MaxPooli  (None, 26, 26, 256)       0         
 ng2D)                                                           
                                                                 
 max_pooling2d_11 (MaxPooli  (None, 13, 13, 256)       0         
 ng2D)                                                           
                                                                 
 conv2d_11 (Conv2D)          (None, 11, 11, 512)       1180160   
                                                                 
 flatten_3 (Flatten)         (None, 61952)             0         
                                                                 
 dense_12 (Dense)            (None, 512)               31719936  
                                                                 
 dense_13 (Dense)            (None, 256)               131328    
                                                                 
 dense_14 (Dense)            (None, 128)               32896     
                                                                 
 dense_15 (Dense)            (None, 1)                 129       
                                                                 
=================================================================
Total params: 33365505 (127.28 MB)
Trainable params: 33365505 (127.28 MB)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________
/home/vianajr/cluster_ages_1/1_single_case/batch_runs/single_case_5im_A.py:411: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.
  plt.figure(figsize=(10, 6))
Training Finished

Tr. Final MSE (nrm. units): 0.012400676496326923
Vl. Final MSE (nrm. units): 0.013252715580165386
Ts. Final MSE (nrm. units): 0.011190607212483883
Tr. Final MdAE (dnrm. units): 0.3552898645401001
Vl. Final MdAE (dnrm. units): 0.38351255416870117
Ts. Final MdAE (dnrm. units): 0.33254538774490355

MODEL 4

Model: "sequential_4"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 conv2d_12 (Conv2D)          (None, 110, 110, 128)     5888      
                                                                 
 max_pooling2d_12 (MaxPooli  (None, 55, 55, 128)       0         
 ng2D)                                                           
                                                                 
 conv2d_13 (Conv2D)          (None, 53, 53, 256)       295168    
                                                                 
 max_pooling2d_13 (MaxPooli  (None, 26, 26, 256)       0         
 ng2D)                                                           
                                                                 
 max_pooling2d_14 (MaxPooli  (None, 13, 13, 256)       0         
 ng2D)                                                           
                                                                 
 conv2d_14 (Conv2D)          (None, 11, 11, 512)       1180160   
                                                                 
 flatten_4 (Flatten)         (None, 61952)             0         
                                                                 
 dense_16 (Dense)            (None, 512)               31719936  
                                                                 
 dense_17 (Dense)            (None, 256)               131328    
                                                                 
 dense_18 (Dense)            (None, 128)               32896     
                                                                 
 dense_19 (Dense)            (None, 1)                 129       
                                                                 
=================================================================
Total params: 33365505 (127.28 MB)
Trainable params: 33365505 (127.28 MB)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________
Training Finished

Tr. Final MSE (nrm. units): 0.012408501468598843
Vl. Final MSE (nrm. units): 0.01335403136909008
Ts. Final MSE (nrm. units): 0.011268164962530136
Tr. Final MdAE (dnrm. units): 0.3560117197036743
Vl. Final MdAE (dnrm. units): 0.3830244493484497
Ts. Final MdAE (dnrm. units): 0.3398545265197754
